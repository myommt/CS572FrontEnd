import{a as j}from"./chunk-C2EWWCXY.js";import{f as Y,i as E,k as T,m as N,n as $,o as I,q as V}from"./chunk-RGHW7JZX.js";import{d as z,e as F}from"./chunk-OEPH3VZB.js";import{Bb as s,Cb as m,Db as _,Eb as v,Ga as o,Kb as y,Lb as C,Mb as k,Na as g,Nb as S,Sa as M,Y as f,cb as u,ea as x,fa as P,hb as b,hc as D,ib as h,ic as w,jb as a,kb as r,mb as B,pb as p,rb as O}from"./chunk-PEAAODBY.js";import"./chunk-4CLCTAJ7.js";var A=(i,e)=>e.value,X=(i,e)=>e.budget_id,q=i=>["/budget",i];function G(i,e){if(i&1&&(a(0,"option",1),s(1),r()),i&2){let t=e.$implicit;u("value",t.value),o(),_(" ",t.display," ")}}function H(i,e){if(i&1){let t=B();a(0,"li",2)(1,"a",6)(2,"span",7),s(3),C(4,"date"),r(),a(5,"span",8),s(6),r(),a(7,"span",9),s(8),r(),a(9,"span",10),s(10),C(11,"currency"),r()(),a(12,"button",11),p("click",function(){let l=x(t).$implicit,d=O();return P(d.deleteBudget(l.budget_id))}),s(13,"X"),r()()}if(i&2){let t=e.$implicit;o(),u("routerLink",y(10,q,t.budget_id)),o(2),m(S(4,5,t.date,"MM/dd/yyyy")),o(3),m(t.title),o(2),m(t.category),o(2),m(k(11,8,t.amount))}}function J(i,e){i&1&&(a(0,"p",3),s(1,"No budget found."),r())}var L=class i{#t=f(z);#e=f(j);budgets=g([]);currentPage=1;pageSize=20;totalBudget=0;totalPages=0;dateOptions=g([]);selectedYear=g(void 0);selectedMonth=g(void 0);dateControl=new E("");constructor(){let e=new Date,t=`${e.getFullYear()}-${("0"+(e.getMonth()+1)).slice(-2)}`;this.dateControl.setValue(t),this.selectedYear.set(e.getFullYear()),this.selectedMonth.set(e.getMonth()+1),this.dateOptions.set(this.generateDateOptions()),this.loadBudget(e.getFullYear(),e.getMonth()+1)}generateDateOptions(){let e=[],t=new Date,n=t.getFullYear()-3,l=t.getFullYear()+1;for(let d=l;d>=n;d--)for(let c=11;c>=0;c--){let R=new Date(d,c);e.push({display:R.toLocaleString("default",{year:"numeric",month:"long"}),value:`${d}-${("0"+(c+1)).slice(-2)}`})}return e}onDateChange(){let e=this.dateControl.value;if(e){let[t,n]=e.split("-").map(Number);this.selectedYear.set(t),this.selectedMonth.set(n),this.currentPage=1,this.loadBudget(t,n)}else console.warn("Selected date is null or undefined")}loadBudget(e,t){let n=e??new Date().getFullYear(),l=t??new Date().getMonth()+1;this.#e.getBudgetCount(n,l).subscribe(d=>{d.success&&(this.totalBudget=d.data,this.totalPages=Math.ceil(this.totalBudget/this.pageSize),this.totalBudget>0?this.#e.getBudgets(this.pageSize,this.currentPage,n,l).subscribe(c=>{c.success&&(this.budgets.set(c.data),this.totalPages=Math.ceil(this.totalBudget/this.pageSize))}):this.budgets.set([]))})}previousPage(){this.currentPage>1&&(this.currentPage--,this.loadBudget(this.selectedYear(),this.selectedMonth()))}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.loadBudget(this.selectedYear(),this.selectedMonth()))}deleteBudget(e){this.#e.deleteBudget(e).subscribe(t=>{t.success&&(this.totalBudget--,this.totalPages=Math.ceil(this.totalBudget/this.pageSize),this.budgets.set(this.budgets().filter(n=>n.budget_id!==e)),this.loadBudget(this.selectedYear(),this.selectedMonth()))})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=M({type:i,selectors:[["app-budgetlist"]],decls:15,vars:7,consts:[[1,"date-dropdown",3,"change","formControl"],[3,"value"],[1,"budget-item"],[1,"no-budget"],[1,"pagination"],[3,"click","disabled"],[1,"budget-link",3,"routerLink"],[1,"budget-date"],[1,"budget-title"],[1,"budget-category"],[1,"budget-amount"],["alt","Delete",1,"delete-button",3,"click"]],template:function(t,n){t&1&&(a(0,"select",0),p("change",function(){return n.onDateChange()}),b(1,G,2,2,"option",1,A),r(),b(3,H,14,12,"li",2,X,!1,J,2,0,"p",3),a(6,"div",4)(7,"button",5),p("click",function(){return n.previousPage()}),s(8,"Previous"),r(),a(9,"span"),s(10),r(),a(11,"button",5),p("click",function(){return n.nextPage()}),s(12,"Next"),r(),a(13,"span"),s(14),r()()),t&2&&(u("formControl",n.dateControl),o(),h(n.dateOptions()),o(2),h(n.budgets()),o(4),u("disabled",n.currentPage===1),o(3),v("Page ",n.currentPage," of ",n.totalPages,""),o(),u("disabled",n.currentPage===n.totalPages),o(3),_("Number of Budgets ",n.totalBudget,""))},dependencies:[D,F,w,V,$,I,N,Y,T],styles:[".delete-button[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff;border:none;border-radius:5px;padding:5px 10px;font-size:14px;cursor:pointer;transition:background-color .3s ease;margin-left:10px}.delete-button[_ngcontent-%COMP%]:hover{background-color:#c0392b}.budget-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px;border-bottom:1px solid #e0e0e0;margin:10px 0;border-radius:8px;background-color:#f8f8f8;box-shadow:0 2px 6px #00000026;transition:background-color .3s ease}.budget-item[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.budget-link[_ngcontent-%COMP%]{display:flex;flex-grow:1;justify-content:space-between;align-items:center;text-decoration:none;color:#333}.budget-date[_ngcontent-%COMP%], .budget-title[_ngcontent-%COMP%], .budget-category[_ngcontent-%COMP%], .budget-amount[_ngcontent-%COMP%]{margin:0 10px}.budget-date[_ngcontent-%COMP%]{flex-basis:15%;font-size:.9em;color:#555}.budget-title[_ngcontent-%COMP%]{flex-basis:35%;font-weight:700;font-size:1em;color:#222}.budget-category[_ngcontent-%COMP%]{flex-basis:20%;font-size:.9em;color:#888}.budget-amount[_ngcontent-%COMP%]{flex-basis:20%;font-size:.9em;text-align:right;color:#27ae60}.no-budget[_ngcontent-%COMP%]{text-align:center;font-size:1.2em;color:#999;padding:20px}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:20px;font-size:1em}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;border:none;border-radius:5px;padding:7px 14px;font-size:14px;cursor:pointer;transition:background-color .3s ease;margin:0 10px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#2980b9}.pagination[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1em;margin:0 10px}.date-dropdown[_ngcontent-%COMP%]{appearance:none;background-color:#f9f9f9;border:1px solid #ccc;border-radius:4px;padding:8px 12px;font-size:14px;font-family:Arial,sans-serif;color:#333;cursor:pointer}.date-dropdown[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background-color:#fff;color:#333}"]})};export{L as BudgetlistComponent};
